<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ö–∏–Ω–æ–±–∞–∑–∞ - –§–∏–ª—å–º—ã –∏ —Å–µ—Ä–∏–∞–ª—ã</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, #1a102b 0%, #2a1545 100%);
      color: #fff;
      min-height: 100vh;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    /* Header */
    .header {
      background: linear-gradient(90deg, #7b2ff7 0%, #9b4dff 100%);
      padding: 20px 0;
      box-shadow: 0 2px 20px rgba(155, 77, 255, 0.3);
      margin-bottom: 40px;
    }

    .header-content {
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .logo {
      font-size: 28px;
      font-weight: 800;
      color: white;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .logo-icon {
      font-size: 32px;
    }

    /* Title */
    .main-title {
      font-size: 36px;
      font-weight: 700;
      margin-bottom: 30px;
      text-align: center;
      background: linear-gradient(90deg, #a05eff, #d37bff);
      
      -webkit-text-fill-color: transparent;
    }

    /* Video Grid */
    .video-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 25px;
      margin-bottom: 50px;
      justify-content: center;
    }

    .video-card {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      overflow: hidden;
      transition: all 0.3s ease;
      border: 1px solid rgba(255, 255, 255, 0.1);
      position: relative;
      cursor: pointer;
    }

    .video-card:hover {
      transform: translateY(-6px);
      box-shadow: 0 10px 25px rgba(155, 77, 255, 0.3);
      border-color: rgba(155, 77, 255, 0.4);
    }

    .card-image {
      width: 100%;
      height: 360px; /* –∫–∞–∫ –Ω–∞ –ö–∏–Ω–æ–ø–æ–∏—Å–∫–µ */
      object-fit: cover;
      background: linear-gradient(45deg, #3b1b63, #5e2b8e);
    }

    .card-content {
      padding: 15px;
    }

    .card-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 8px;
      line-height: 1.3;
      display: -webkit-box;
      
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .card-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .card-year {
      background: linear-gradient(90deg, #7b2ff7, #d37bff);
      padding: 4px 10px;
      border-radius: 10px;
      font-size: 12px;
      font-weight: 600;
    }

    .card-rating {
      display: flex;
      align-items: center;
      gap: 5px;
      font-size: 14px;
      color: #ffda79;
    }
    

    .card-description {
      font-size: 13px;
      color: #bbb;
      line-height: 1.4;
      display: -webkit-box;
      
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .card-badge {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(123, 47, 247, 0.8);
      padding: 5px 10px;
      border-radius: 8px;
      font-size: 11px;
      font-weight: 600;
      backdrop-filter: blur(6px);
    }

    /* Modal */
    .video-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(10, 0, 25, 0.95);
      z-index: 1000;
      backdrop-filter: blur(10px);
    }

    .video-modal.active {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .modal-content {
      position: relative;
      width: 90%;
      max-width: 1000px;
      background: #1a102b;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 25px 50px rgba(80, 0, 130, 0.6);
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px;
      background: rgba(123, 47, 247, 0.2);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .modal-title {
      font-size: 22px;
      font-weight: 600;
      color: white;
    }

    .close-btn {
      background: none;
      border: none;
      color: white;
      font-size: 28px;
      cursor: pointer;
      padding: 5px;
      border-radius: 50%;
      transition: all 0.3s ease;
    }

    .close-btn:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .video-player {
      width: 100%;
      height: 0;
      padding-bottom: 56.25%;
      position: relative;
    }

    .video-player video {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #000;
    }

    /* Footer */
    .footer {
      background: rgba(0, 0, 0, 0.5);
      padding: 40px 0;
      margin-top: 60px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .footer-content {
      text-align: center;
      color: #999;
    }

    /* Loading */
    .loading {
      text-align: center;
      padding: 60px 20px;
      font-size: 18px;
      color: #ccc;
    }

    .loading-spinner {
      width: 40px;
      height: 40px;
      border: 4px solid rgba(255, 255, 255, 0.1);
      border-left: 4px solid #a05eff;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Responsive */
    @media (max-width: 768px) {
      .video-grid {
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      }

      .card-image {
        height: 320px;
      }
    }

    @media (max-width: 480px) {
      .video-grid {
        grid-template-columns: 1fr;
      }

      .card-image {
        height: 280px;
      }
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js/dist/umd/supabase.min.js"></script>
</head>
<body>
  <header class="header">
    <div class="container">
      <div class="header-content">
        <a href="#" class="logo">
          <span class="logo-icon">üé¨</span>
          –ö–ò–ù–û–ë–ê–ó–ê
        </a>
      </div>
    </div>
  </header>
  

  <main class="container">

  <!-- –ü–æ–∏—Å–∫–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ -->
  <div style="text-align: center; margin-bottom: 30px;">
    <input type="text" id="searchInput" placeholder="–ü–æ–∏—Å–∫ —Ñ–∏–ª—å–º–∞..." 
           style="padding: 10px 15px; width: 80%; max-width: 400px; border-radius: 10px; border: none; font-size: 16px;">
  </div>

  <div id="videoList" class="video-grid">
    <div class="loading">
      <div class="loading-spinner"></div>
      –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∏–ª—å–º–æ–≤...
    </div>
  </div>
</main>

  <div id="videoModal" class="video-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="modalTitle" class="modal-title">–ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞</h3>
        <button id="closeModal" class="close-btn">&times;</button>
      </div>
      <div class="video-player">
        <video id="videoPlayer" controls>
          –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ —Ç–µ–≥.
        </video>
      </div>
    </div>
  </div>

  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <p>¬© 2025 –ö–∏–Ω–æ–±–∞–∑–∞.</p>
      </div>
    </div>
  </footer>

  <script>
    const SUPABASE_URL = 'https://qcurledxueavufctgoaw.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFjdXJsZWR4dWVhdnVmY3Rnb2F3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzQ0NDU3MDcsImV4cCI6MjA1MDAyMTcwN30.vGgxeCv3T4jWqEexriRxD3cQWwsdt1tSyR_woIxcHzI'; // –æ—Å—Ç–∞–≤—å —Å–≤–æ–π –∫–ª—é—á
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    const videoModal = document.getElementById('videoModal');
    const videoPlayer = document.getElementById('videoPlayer');
    const modalTitle = document.getElementById('modalTitle');
    const closeModal = document.getElementById('closeModal');

    function getRandomRating() {
      return (Math.random() * 3 + 7).toFixed(1);
    }

    function generateDescription(year) {
      const currentYear = new Date().getFullYear();
      const yearsAgo = currentYear - year;
      if (yearsAgo <= 2) {
        return "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ö–∏—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Å—É–∂–¥–∞—é—Ç –≤—Å–µ –∑—Ä–∏—Ç–µ–ª–∏ –∏ –∫—Ä–∏—Ç–∏–∫–∏.";
      } else if (yearsAgo <= 10) {
        return "–ö–ª–∞—Å—Å–∏–∫–∞ –Ω–æ–≤–æ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è, –ø–æ–ª—É—á–∏–≤—à–∞—è –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ –ø—É–±–ª–∏–∫–∏.";
      } else {
        return "–§–∏–ª—å–º, —Å—Ç–∞–≤—à–∏–π –ª–µ–≥–µ–Ω–¥–æ–π –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π –≤—Ä–µ–º–µ–Ω–µ–º.";
      }
    }

    function openVideoPlayer(videoUrl, videoName) {
      modalTitle.textContent = videoName;
      videoPlayer.src = videoUrl;
      videoModal.classList.add('active');
      videoPlayer.play();
    }

    function closeVideoPlayer() {
      videoModal.classList.remove('active');
      videoPlayer.pause();
      videoPlayer.currentTime = 0;
    }

    async function loadVideos() {
      const list = document.getElementById('videoList');
      try {
        const { data, error } = await supabase.from('Video').select('*').order('id', { ascending: false });
        if (error) throw error;
        if (!data || data.length === 0) {
          list.innerHTML = '<div class="loading">–§–∏–ª—å–º—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
          return;
        }
        list.innerHTML = data.map(item => {
          const rating = getRandomRating();
          const description = generateDescription(item.–ì–æ–¥);
          return `
            <div class="video-card" onclick="openVideoPlayer('${item.url}', '${(item.–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è').replace(/'/g, "\\'")}')">
              ${item.–ò–∫–æ–Ω–∫–∞ ? 
                `<img src="${item.–ò–∫–æ–Ω–∫–∞}" alt="${item.–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ || ''}" class="card-image" />` : 
                `<div class="card-image" style="display: flex; align-items: center; justify-content: center; color: #999;">–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</div>`}
              <div class="card-badge">–ö–∏–Ω–æ</div>
              <div class="card-content">
                <h3 class="card-title">${item.–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è'}</h3>
                <div class="card-meta">
                  <span class="card-year">${item.–ì–æ–¥ || '‚Äî'}</span>
                  <span class="card-rating">‚≠ê ${rating}</span>
                </div>
                <p class="card-description">${description}</p>
              </div>
            </div>
          `;
        }).join('');
      } catch (error) {
        console.error('–û—à–∏–±–∫–∞:', error);
        list.innerHTML = `<div class="loading" style="color: #ff6b6b;">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö</div>`;
      }
    }

    closeModal.addEventListener('click', closeVideoPlayer);
    videoModal.addEventListener('click', e => { if (e.target === videoModal) closeVideoPlayer(); });
    document.addEventListener('keydown', e => { if (e.key === 'Escape') closeVideoPlayer(); });
    loadVideos();

let allVideos = []; // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–∏—Å–∫–∞

async function loadVideos() {
  const list = document.getElementById('videoList');
  try {
    const { data, error } = await supabase.from('Video').select('*').order('id', { ascending: false });
    if (error) throw error;
    allVideos = data || [];

    renderVideos(allVideos);
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞:', error);
    list.innerHTML = `<div class="loading" style="color: #ff6b6b;">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö</div>`;
  }
}

function renderVideos(videos) {
  const list = document.getElementById('videoList');
  if (!videos || videos.length === 0) {
    list.innerHTML = '<div class="loading">–§–∏–ª—å–º—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
    return;
  }
  list.innerHTML = videos.map(item => {
    const rating = getRandomRating();
    const description = generateDescription(item.–ì–æ–¥);
    return `
      <div class="video-card" onclick="openVideoPlayer('${item.url}', '${(item.–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è').replace(/'/g, "\\'")}')">
        ${item.–ò–∫–æ–Ω–∫–∞ ? 
          `<img src="${item.–ò–∫–æ–Ω–∫–∞}" alt="${item.–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ || ''}" class="card-image" />` : 
          `<div class="card-image" style="display: flex; align-items: center; justify-content: center; color: #999;">–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</div>`}
        <div class="card-badge">–ö–∏–Ω–æ</div>
        <div class="card-content">
          <h3 class="card-title">${item.–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è'}</h3>
          <div class="card-meta">
            <span class="card-year">${item.–ì–æ–¥ || '‚Äî'}</span>
            <span class="card-rating">‚≠ê ${rating}</span>
          </div>
          <p class="card-description">${description}</p>
        </div>
      </div>
    `;
  }).join('');
}

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ–∏—Å–∫–∞
document.getElementById('searchInput').addEventListener('input', (e) => {
  const query = e.target.value.toLowerCase();
  const filtered = allVideos.filter(v => (v.–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ || '').toLowerCase().includes(query));
  renderVideos(filtered);
});

closeModal.addEventListener('click', closeVideoPlayer);
videoModal.addEventListener('click', e => { if (e.target === videoModal) closeVideoPlayer(); });
document.addEventListener('keydown', e => { if (e.key === 'Escape') closeVideoPlayer(); });

loadVideos();


  </script>
</body>
</html>
